length(which(base_salarios$Sexo==2)) # 73279
summary(base_salarios$Coutas[base_salarios$Sexo == 2])
summary(base_salarios$Ultimo.Salario[base_salarios$Sexo == 2])
varianza_cuotas_mujeres <- var(base_salarios$Coutas[base_salarios$Sexo == 2])
varianza_salarios_mujeres <- var(base_salarios$Ultimo.Salario[base_salarios$Sexo == 2])
# Crea el gráfico de caja y bigotes con ggplot2
bp <- ggplot(base_salarios, aes(x = Sexo, y = Ultimo.Salario)) +
geom_boxplot() +
theme_cowplot() +
scale_x_discrete(labels = c("Hombre", "Mujer")) +
labs(x = "Sexo", y = "Ultimo salario reportado")
# Muestra el gráfico
print(bp)
# Convierte la variable Sexo en un factor con etiquetas
base_salarios$Sexo <- factor(base_salarios$Sexo, levels = c(1, 2), labels = c("Hombre", "Mujer"))
# Crea el gráfico de caja y bigotes con ggplot2
bp <- ggplot(base_salarios, aes(x = Sexo, y = Ultimo.Salario)) +
geom_boxplot() +
theme_cowplot() +
scale_x_discrete(labels = c("Hombre", "Mujer")) +
labs(x = "Sexo", y = "Ultimo salario reportado")
# Muestra el gráfico
print(bp)
base_salarios
# Crea el gráfico de caja y bigotes con ggplot2
boxplot_salarios <- ggplot(base_salarios, aes(x = Sexo, y = Ultimo.Salario, fill = Sexo)) +
geom_boxplot() +
theme_cowplot() +
scale_x_discrete(labels = c("Hombre", "Mujer")) +
scale_fill_manual(values = c("Hombre" = "lightblue", "Mujer" = "lightgreen")) +
labs(x = "Sexo", y = "Ultimo salario reportado")
# Muestra el gráfico
print(boxplot_salarios)
base_salarios_temp$Sexo <- factor(base_salarios$Sexo, levels = c(1, 2), labels = c("Hombre", "Mujer"))
# Crea el gráfico de caja y bigotes con ggplot2
boxplot_salarios <- ggplot(base_salarios, aes(x = Sexo, y = Ultimo.Salario, fill = Sexo)) +
geom_boxplot() +
theme_cowplot() +
scale_x_discrete(labels = c("Hombre", "Mujer")) +
scale_fill_manual(values = c("Hombre" = "lightblue", "Mujer" = "lightgreen")) +
labs(x = "Sexo", y = "Ultimo salario reportado")
# Muestra el gráfico
print(boxplot_salarios)
source("~/estadisticaII/estadisticaII/R.R")
library(cowplot)
library(stringr) # para cambiar todas las commas a puntos en la columna Ultimo Salario
library(ggplot2) # para hacer los gráficos
library(univariateML) # para hacer el análisis AIC
library(rriskDistributions) # para hacer el análisis AIC
library(boot) # para hacer el bootstrap
library(ks) # para Kernel smoothing
library(cowplot) # para hacer graficos más atractivos
base_salarios <- read.csv("BaseSalarios.csv",  sep = ";")
base_salarios$Fec.Nac <- as.Date(base_salarios$Fec.Nac, format = "%d/%m/%Y")
colnames(base_salarios)[5] ="Ultimo.Salario"
base_salarios <- subset(base_salarios, select = -X)
base_salarios$Ultimo.Salario <- as.numeric(str_replace_all(base_salarios$Ultimo.Salario, ",", "."))
---
title: "Tarea 1"
source("~/estadisticaII/estadisticaII/R.R")
knitr::opts_chunk$set(echo = TRUE)
density_biweight <- density(base_salarios$Ultimo.Salario,kernel = "biweight")
density_biweight <- density(base_salarios$Ultimo.Salario,kernel = "biweight")
density_biweight
plot(density_biweight, main = "Biweight kernel", ylab = "Densidad")
ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
library(ggplot2)
ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
library(cowplot)
ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
lines(density_biweight,lwd=2,lty=1)
plot(density_biweight, main = "Biweight kernel", ylab = "Densidad")
ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
lines(density_biweight,lwd=2,lty=1)
plot(density_biweight, main = "Biweight kernel", ylab = "Densidad")
ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
lines(density_biweight,lwd=2,lty=1)
density_biweight <- density(base_salarios$Ultimo.Salario,kernel = "biweight")
plot(density_biweight, main = "Biweight kernel", ylab = "Densidad")
ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
lines(density_biweight,lwd=2,lty=1)
density_plot <- ggplot() +
geom_line(data = as.data.frame(density_biweight), aes(x = x, y = y), color = "red4", size = 2) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot <- ggplot(data.frame(x = density_biweight$x, y = density_biweight$y), aes(x = x, y = y)) +
geom_line(color = "red4", size = 2) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot
density_plot <- ggplot() +
geom_line(data = as.data.frame(density_biweight), aes(x = x, y = y), color = "red4", linewidth = 2) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot <- ggplot(data.frame(x = density_biweight$x, y = density_biweight$y), aes(x = x, y = y)) +
geom_line(color = "red4", linewidth = 2) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot <- ggplot() +
geom_line(data = as.data.frame(density_biweight), aes(x = x, y = y), color = "red4", linewidth = 2) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot <- ggplot(data.frame(x = density_biweight$x, y = density_biweight$y), aes(x = x, y = y)) +
geom_line(color = "red4", linewidth = 2) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot <- ggplot() +
geom_line(data = as.data.frame(density_biweight), aes(x = x, y = y), color = "red4", linewidth = 2) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot <- ggplot() +
+   geom_line(data = as.data.frame(density_biweight), aes(x = x, y = y), color = "red4", linewidth = 2) +
+   labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
+   theme_cowplot() +
+   scale_x_continuous(
+     breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
density_plot <- ggplot(data.frame(x = density_biweight$x, y = density_biweight$y), aes(x = x, y = y)) +
geom_line(color = "red4", size = 2) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot
combined_plot <- ggdraw() +
draw_plot(histogram_plot, x = 0, y = 0, width = 0.8, height = 0.8) +
draw_plot(density_plot, x = 0, y = 0, width = 0.8, height = 0.8)
histogram_plot <- ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot <- ggplot(data.frame(x = density_biweight$x, y = density_biweight$y), aes(x = x, y = y)) +
geom_line(color = "red4", size = 2) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
combined_plot <- ggdraw() +
draw_plot(histogram_plot, x = 0, y = 0, width = 0.8, height = 0.8) +
draw_plot(density_plot, x = 0, y = 0, width = 0.8, height = 0.8)
combined_plot
density_plot <- ggplot(data.frame(x = density_biweight$x, y = density_biweight$y), aes(x = x, y = y)) +
geom_line(color = "red4", size = 1) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
combined_plot <- ggdraw() +
draw_plot(histogram_plot, x = 0, y = 0, width = 0.8, height = 0.8) +
draw_plot(density_plot, x = 0, y = 0, width = 0.8, height = 0.8)
combined_plot
density_plot <- ggplot(data.frame(x = density_biweight$x, y = density_biweight$y), aes(x = x, y = y)) +
geom_line(color = "red4", size = 1)  +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
combined_plot <- ggdraw() +
draw_plot(histogram_plot, x = 0, y = 0, width = 0.8, height = 0.8) +
draw_plot(density_plot, x = 0, y = 0, width = 0.8, height = 0.8)
histogram_plot <- ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
theme_cowplot() +
theme(axis.title.y = element_blank()) +  # Quitar el eje y
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot <- ggplot(data.frame(x = density_biweight$x, y = density_biweight$y), aes(x = x, y = y)) +
geom_line(color = "red4", size = 1) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
combined_plot <- ggdraw() +
draw_plot(histogram_plot, x = 0, y = 0, width = 0.8, height = 0.8) +
draw_plot(density_plot, x = 0, y = 0, width = 0.8, height = 0.8)
combined_plot
histogram_plot <- ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot <- ggplot(data.frame(x = density_biweight$x, y = density_biweight$y), aes(x = x, y = y)) +
geom_line(color = "red4", size = 1) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
combined_plot <- ggdraw() +
draw_plot(histogram_plot, x = 0, y = 0, width = 0.8, height = 0.8) +
draw_plot(density_plot, x = 0, y = 0, width = 0.8, height = 0.8)
combined_plot
histogram_plot <- ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = " ", x = " ", y = " ") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
density_plot <- ggplot(data.frame(x = density_biweight$x, y = density_biweight$y), aes(x = x, y = y)) +
geom_line(color = "red4", size = 1) +
labs(title = "Densidad con Kernel Biweight", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
combined_plot <- ggdraw() +
draw_plot(histogram_plot, x = 0, y = 0, width = 0.8, height = 0.8) +
draw_plot(density_plot, x = 0, y = 0, width = 0.8, height = 0.8)
combined_plot
ggplot(base_salarios, aes(x = Ultimo.Salario, y = ..density..)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
ggplot(base_salarios, aes(x = Ultimo.Salario, y = ..density..)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
ggplot(base_salarios, aes(x = Ultimo.Salario, y = ..density..)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
) +
geom_line(data = density_biweight)
ggplot(base_salarios, aes(x = Ultimo.Salario, y = ..density..)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
) +
geom_line(data = as.data.frame(density_biweight))
ggplot(base_salarios, aes(x = Ultimo.Salario, y = ..density..)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Densidad") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
) +
geom_line(density_biweight)
density_biweight <- density(base_salarios$Ultimo.Salario, kernel = "biweight")
density_biweight
density_normal <- density(ult.salario,kernel = "gaussian")
max(base_salarios$Ultimo.Salario)
View(base_salarios)
View(base_salarios)
1e-3
tinytex::install_tinytex()
table(base_salarios$Sexo)
sum(base_salarios$Sexo == 1)
length(base_salarios$Ultimo.Salario[base_salarios$Sexo == 1])
length(base_salarios$Ultimo.Salario[base_salarios$Sexo == 2])
t_test_result <- t.test(Ultimo.Salario ~ Sexo, data = base_salarios, alternative = "two.sided", conf.level = 0.95)
73279/106000
32721/106000
1156468.24-1046661.46
8154905.08-7290150.00
knitr::opts_chunk$set(echo = TRUE)
mode(base_salarios$Ultimo.Salario)
mode(as.numeric(base_salarios$Ultimo.Salario))
max(base_salarios$Ultimo.Salario) - min(base_salarios$Ultimo.Salario)) / 30
(max(base_salarios$Ultimo.Salario) - min(base_salarios$Ultimo.Salario) / 30
library(stringr) # para cambiar todas las commas a puntos en la columna Ultimo Salario
library(ggplot2) # para hacer los gráficos
library(univariateML) # para hacer el análisis AIC
library(rriskDistributions) # para hacer el análisis AIC
library(boot) # para hacer el bootstrap
library(ks) # para Kernel smoothing
library(cowplot) # para hacer graficos más atractivos
library(scales)
#---CSV y formatos--------------------------------------------------------
# Abrir y dar formato a la base de datos
base_salarios <- read.csv("BaseSalarios.csv",  sep = ";")
base_salarios$Fec.Nac <- as.Date(base_salarios$Fec.Nac, format = "%d/%m/%Y")
colnames(base_salarios)[5] ="Ultimo.Salario"
base_salarios <- subset(base_salarios, select = -X)
base_salarios$Ultimo.Salario <- as.numeric(str_replace_all(base_salarios$Ultimo.Salario, ",", "."))
#---Parte I----------------------------------------------------
#Hombres
length(which(base_salarios$Sexo==1)) # 32723
summary(base_salarios$Coutas[base_salarios$Sexo == 1])
summary(base_salarios$Ultimo.Salario[base_salarios$Sexo == 1])
varianza_cuotas_hombres <- var(base_salarios$Coutas[base_salarios$Sexo == 1])
varianza_salarios_hombres <- var(base_salarios$Ultimo.Salario[base_salarios$Sexo == 1])
#Mujeres
length(which(base_salarios$Sexo==2)) # 73279
summary(base_salarios$Coutas[base_salarios$Sexo == 2])
summary(base_salarios$Ultimo.Salario[base_salarios$Sexo == 2])
varianza_cuotas_mujeres <- var(base_salarios$Coutas[base_salarios$Sexo == 2])
varianza_salarios_mujeres <- var(base_salarios$Ultimo.Salario[base_salarios$Sexo == 2])
#Boxplot
boxplot(Ultimo.Salario ~ Sexo, data = base_salarios, col = c("lightblue", "lightgreen"),
main = "Boxplot de último salario por sexo",
xlab = "Sexo", ylab = "Ultimo salario reportado",
names = c("Hombre", "Mujer"))
#Comparacion de medias
t.test(
x           = base_salarios$Ultimo.Salario[base_salarios$Sexo == 1],
y           = base_salarios$Ultimo.Salario[base_salarios$Sexo == 2],
paired      = FALSE,
alternative = "two.sided",
conf.level  = 0.95
)
#---Parte II----------------------------------------------------
#Histograma salarios
ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
#Kernels
kernels <- eval(formals(density.default)$kernel)[1:6]
hist(base_salarios$Ultimo.Salario, breaks = 100, main= "Distribucion Salarios por Kernels", freq=FALSE)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[1]), col = 1,lwd=2,lty=1)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[2]), col = 2,lwd=2,lty=1)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[3]), col = 3,lwd=2,lty=1)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[4]), col = 4,lwd=2,lty=1)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[5]), col = 5,lwd=2,lty=1)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[6]), col = 6,lwd=2,lty=1)
legend("topright", legend = kernels, col = seq(kernels), lty = 1,lwd = 2,cex = 0.5)
#---Parte III----------------------------------------------------
#Criterio de informacion Akaike
model_select(base_salarios$Ultimo.Salario)
fit.cont(base_salarios$Ultimo.Salario)
library(stringr) # para cambiar todas las commas a puntos en la columna Ultimo Salario
library(ggplot2) # para hacer los gráficos
library(univariateML) # para hacer el análisis AIC
library(rriskDistributions) # para hacer el análisis AIC
library(boot) # para hacer el bootstrap
library(ks) # para Kernel smoothing
library(cowplot) # para hacer graficos más atractivos
library(scales)
base_salarios <- read.csv("BaseSalarios.csv",  sep = ";")
base_salarios$Fec.Nac <- as.Date(base_salarios$Fec.Nac, format = "%d/%m/%Y")
library(stringr) # para cambiar todas las commas a puntos en la columna Ultimo Salario
library(ggplot2) # para hacer los gráficos
library(univariateML) # para hacer el análisis AIC
library(rriskDistributions) # para hacer el análisis AIC
library(boot) # para hacer el bootstrap
library(ks) # para Kernel smoothing
library(cowplot) # para hacer graficos más atractivos
library(scales)
base_salarios <- read.csv("BaseSalarios.csv",  sep = ";")
base_salarios$Fec.Nac <- as.Date(base_salarios$Fec.Nac, format = "%d/%m/%Y")
colnames(base_salarios)[5] ="Ultimo.Salario"
base_salarios <- subset(base_salarios, select = -X)
base_salarios$Ultimo.Salario <- as.numeric(str_replace_all(base_salarios$Ultimo.Salario, ",", "."))
base_salarios <- base_salarios[-84807, ] # corresponde al salario 13 199 892
base_salarios <- base_salarios[-96367, ] # corresponde al salario 13 110 539
max(base_salarios$Ultimo.Salario)
length(which(base_salarios$Sexo==1)) # 32723
summary(base_salarios$Coutas[base_salarios$Sexo == 1])
summary(base_salarios$Ultimo.Salario[base_salarios$Sexo == 1])
varianza_cuotas_hombres <- var(base_salarios$Coutas[base_salarios$Sexo == 1])
varianza_salarios_hombres <- var(base_salarios$Ultimo.Salario[base_salarios$Sexo == 1])
#Mujeres
length(which(base_salarios$Sexo==2)) # 73279
summary(base_salarios$Coutas[base_salarios$Sexo == 2])
summary(base_salarios$Ultimo.Salario[base_salarios$Sexo == 2])
varianza_cuotas_mujeres <- var(base_salarios$Coutas[base_salarios$Sexo == 2])
varianza_salarios_mujeres <- var(base_salarios$Ultimo.Salario[base_salarios$Sexo == 2])
#Boxplot
boxplot(Ultimo.Salario ~ Sexo, data = base_salarios, col = c("lightblue", "lightgreen"),
main = "Boxplot de último salario por sexo",
xlab = "Sexo", ylab = "Ultimo salario reportado",
names = c("Hombre", "Mujer"))
#Comparacion de medias
t.test(
x           = base_salarios$Ultimo.Salario[base_salarios$Sexo == 1],
y           = base_salarios$Ultimo.Salario[base_salarios$Sexo == 2],
paired      = FALSE,
alternative = "two.sided",
conf.level  = 0.95
)
#---Parte II----------------------------------------------------
#Histograma salarios
ggplot(base_salarios, aes(x = Ultimo.Salario)) +
geom_histogram(binwidth = 150000, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histograma de los últimos salarios reportados", x = "Salario en miles de colones", y = "Frecuencia") +
theme_cowplot() +
scale_x_continuous(
breaks = seq(min(base_salarios$Ultimo.Salario), max(base_salarios$Ultimo.Salario), length.out = 8),
labels = scales::label_number(big.mark = " ", decimal.mark = ".", scale = 1e-3)
)
#Kernels
kernels <- eval(formals(density.default)$kernel)[1:6]
hist(base_salarios$Ultimo.Salario, breaks = 100, main= "Distribucion Salarios por Kernels", freq=FALSE)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[1]), col = 1,lwd=2,lty=1)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[2]), col = 2,lwd=2,lty=1)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[3]), col = 3,lwd=2,lty=1)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[4]), col = 4,lwd=2,lty=1)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[5]), col = 5,lwd=2,lty=1)
lines(density(base_salarios$Ultimo.Salario ,kernel=kernels[6]), col = 6,lwd=2,lty=1)
legend("topright", legend = kernels, col = seq(kernels), lty = 1,lwd = 2,cex = 0.5)
#---Parte III----------------------------------------------------
#Criterio de informacion Akaike
model_select(base_salarios$Ultimo.Salario)
fit.cont(base_salarios$Ultimo.Salario)
